stages:
 - benchmark
 - publish

sysbench-benchmark:
  image: registry.gitlab.com/tarantool/sysbench/benchmarking
  stage: benchmark
  artifacts:
    paths:
      - ./benchmarking/result.txt
      - ./benchmarking/version.txt
  script:
    - ./benchmarking/run-from-docker.sh
  only:
    - triggers

sysbench-publish:
  image: registry.gitlab.com/tarantool/sysbench/publication
  stage: publish
  script:
    - cat ./benchmarking/result.txt
    - cat ./benchmarking/version.txt
    - ./result-publication/main.py ./benchmarking/result.txt ./benchmarking/version.txt
  only:
    - triggers
